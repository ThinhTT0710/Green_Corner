@model IEnumerable<OrderDTO>
@{
	ViewData["Title"] = "Đơn hàng";
	int index = 1;
}
<div class="page-header breadcrumb-wrap">
	<div class="container">
		<div class="breadcrumb">
			<a href="/Home" rel="nofollow"><i class="fi-rs-home mr-5"></i>Home</a>
			<span></span> Đơn hàng của tôi
		</div>
	</div>
</div>
<div class="page-content pt-50 pb-50">
	<div class="container">
		<div class="row">
			<div class="col-lg-10 m-auto">
				<div class="row">
					<div class="col-md-3">
						<div class="dashboard-menu">
							<ul class="nav flex-column" role="tablist">
								<ul class="nav flex-column" role="tablist">
									<li class="nav-item">
										<a class="nav-link" asp-controller="User" asp-action="Profile">
											<i class="fi-rs-user mr-10"></i>Thông tin
											tài khoản
										</a>
									</li>
									<li class="nav-item">
										<a class="nav-link" asp-controller="Event" asp-action="GetOpenEventsByTeamLeader">
											<i class="fi-rs-settings-sliders mr-10"></i>Sự kiện bạn quản lý
										</a>
									</li>
									<li class="nav-item">
										<a class="nav-link" id="achievements-tab" href="/User/Achievements" role="tab"
										   aria-controls="achievements" aria-selected="true">
											<i class="fi fi-rs-trophy mr-10"></i>Thành tích của tôi
										</a>
									</li>
									<li class="nav-item">
										<a class="nav-link active" asp-controller="Order" asp-action="History">
											<i class="fi-rs-shopping-bag mr-10"></i>Đơn hàng
										</a>
									</li>
									<li class="nav-item">
										<a class="nav-link" asp-controller="User" asp-action="ReportHistory">
											<i class="fi-rs-shopping-cart-check mr-10"></i>Lịch sử báo cáo
										</a>
									</li>
									<li class="nav-item">
										<a class="nav-link" href="~/User/GetRewardRedemptionHistory">
											<i class="fi-rs-marker mr-10"></i>Lịch sử đổi thưởng
										</a>
									</li>
									<li class="nav-item dropdown">
										<a class="nav-link dropdown-toggle" href="#" id="feedbackReportDropdown" role="button" data-bs-toggle="dropdown"
										   aria-expanded="false">
											<i class="fi fi-rs-comment-alt mr-10"></i> Góp ý & Báo cáo
										</a>
										<ul class="dropdown-menu" aria-labelledby="feedbackReportDropdown">
											<li>
												<a class="dropdown-item" href="/BlogPost/SubmitFeedback">
													<i class="fi fi-rs-bubble-dots mr-10"></i> Gửi góp ý
												</a>
											</li>
											<li>
												<a class="dropdown-item" href="/BlogPost/SubmitReport">
													<i class="fi fi-rs-warning mr-10"></i> Gửi báo cáo
												</a>
											</li>
										</ul>
									</li>
									<li class="nav-item">
										<a class="nav-link" href="/User/ViewParticipatedActivities">
											<i class="fi fi-rs-browser mr-10"></i> Lịch sử hoạt động
										</a>
									</li>
									<li class="nav-item">
										<a class="nav-link" href="/Event/EventReviewHistory">
											<i class="fi fi-rs-browser mr-10"></i> Lịch sử hoạt động đánh giá
										</a>
									</li>
									<li class="nav-item">
										<a class="nav-link" href="/Event/LeaderReviewHistory">
											<i class="fi fi-rs-browser mr-10"></i> Lịch sử đánh giá đội trưởng
										</a>
									</li>
									<li class="nav-item">
										<a class="nav-link" asp-controller="User" asp-action="ChangePassword">
											<i class="fi-rs-marker mr-10"></i>Thay đổi mật khẩu
										</a>
									</li>
									<li class="nav-item">
										<a class="nav-link" asp-controller="Auth" asp-action="Logout">
											<i class="fi-rs-sign-out mr-10"></i>Đăng
											xuất
										</a>
									</li>
								</ul>
						</div>
					</div>
					@if (!Model.Any())
                    {
                        <div class="col-md-9">
                            <div class="alert alert-info" role="alert">
                                <h4 class="alert-heading">Không có đơn hàng nào</h4>
                                <p>Hiện tại bạn chưa có đơn hàng nào. Hãy mua sắm ngay để trải nghiệm dịch vụ của chúng tôi!</p>
                            </div>
                        </div>
                    }
					else
					{
					<div class="col-md-9">
						<div class="tab-content account dashboard-content pl-50">
							<div class="tab-pane fade active show" id="orders" role="tabpanel"
								aria-labelledby="orders-tab">
								<div class="card">
									<div class="card-header">
										<h3 class="mb-0">Đơn hàng của bạn</h3>
									</div>
									<div class="card-body">
										<div class="table-responsive">
											<table class="table">
												<thead>
													<tr>
														<th>Đơn hàng</th>
														<th>Ngày đặt hàng</th>
														<th>Phương thức thành toán</th>
														<th>Tổng cộng</th>
														<th>Trạng thái</th>
														<th></th>
													</tr>
												</thead>
												<tbody>
													@foreach (var order in Model)
													{
															<tr>
															<td>@index</td>
															<td>@order.CreatedAt.ToString("dd/MM/yyyy")</td>
															<td>@order.PaymentMethod</td>
															<td>@order.TotalMoney.ToString("N0", new CultureInfo("vi-VN"))đ
															</td>
															<td>@order.Status</td>
															<td>
																@if (order.Status == "Chờ xác nhận")
																{
																	<form method="post" asp-action="CancelOrder"
																		asp-controller="Order">
																		<input type="hidden" name="orderId"
																			value="@order.OrderId" />
																		<button type="submit" class="btn-sm" style="font-size: 12px;">Hủy đơn hàng</button>
																	</form>
																}
															</td>
															</tr>
															index++;
														}
												</tbody>
											</table>
										</div>
									</div>
								</div>
							</div>
						</div>
					</div>
					}
				</div>
			</div>
		</div>
	</div>
</div>

@section Scripts {
	<partial name="_ValidationScriptsPartial" />
}
