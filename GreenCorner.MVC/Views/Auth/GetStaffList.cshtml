﻿
@model IEnumerable<UserDTO>
@{
    ViewData["Title"] = "Quản lí nhân viên";
    Layout = "~/Views/Shared/_LayoutAdmin.cshtml";
}
<section class="content-main">
    <div class="content-header">
        <h2 class="content-title">Danh sách nhân viên</h2>
    </div>
	<div class="card mb-4">
        <header class="card-header">
            <div class="row gx-3">
                <div class="col-lg-4 col-md-6 me-auto">
                    <input type="text" id="searchInput" placeholder="Tìm kiếm..." class="form-control" />
                </div>
                <div class="col-lg-2 col-md-3 col-6">
                    <select id="statusFilter" class="form-select">
    <option value="">Trạng thái</option>
    <option value="false">Hoạt động</option>
    <option value="true">Bị chặn</option>
</select>
                </div>
                <div class="col-lg-2 col-md-3 col-6">
			<a asp-action="CreateStaff" class="btn btn-outline-primary"><i class="bi bi-plus-square"></i> Tạo nhân viên mới</a>
                </div>
            </div>
        </header>
        <!-- card-header end// -->
        <div class="card-body">
            <div class="table-responsive">
		<table class="table table-hover">
			<thead>
				<tr>
					<th>Họ và tên</th>
					<th>Địa chỉ</th>
					<th>Email</th>
					<th>Số điện thoại</th>
					<th>Trạng thái</th>
					<th class="text-end"></th>
				</tr>
			</thead>
			
			<tbody>
				@foreach (var item in Model)
				{
				<tr data-fullname="@item.FullName.ToLower()" data-status="@item.IsBan.ToString().ToLower()">
					<td width="40%">
						  <div class="info pl-3">
                                        <h6 class="mb-0 title">@item.FullName</h6>
										</div>
					</td>
					<td>
						@item.Address
					</td>
					<td>
						@item.Email
					</td>
					<td>
						@item.PhoneNumber
					</td>
					 @if (!item.IsBan)
                                {
                                    <td><span class="badge rounded-pill badge-soft-success">Hoạt động</span></td>
                                }
                                else
                                {
                                    <td><span class="badge rounded-pill badge-soft-danger">Bị khóa</span></td>
                                }
					<td class="text-end">
									<a class="btn btn-sm btn-brand rounded font-sm mt-15"  asp-action="UpdateStaff" asp-route-userId="@item.ID" >
									Cập nhật
							</a>
							@{if(@item.IsBan){
											<a class="btn btn-sm btn-brand rounded font-sm mt-15" asp-action="UnBlockStaff" asp-route-staffID="@item.ID">
										UnBlock Account
							</a>
							}else{
											<a class="btn btn-sm btn-brand rounded font-sm mt-15" asp-action="BlockStaff" asp-route-staffID="@item.ID">
									Block Account
							</a>
							}
							}
					</td>
				</tr>
				}
			</tbody>
		</table
	</div>
        </div>
    </div>
<div class="pagination-area mt-15 mb-50">
        <nav aria-label="Page navigation example">
            <ul class="pagination justify-content-start">
            </ul>
        </nav>
    </div>
</section>
@section Scripts {
<script>
    document.addEventListener("DOMContentLoaded", function () {
        const searchInput = document.getElementById("searchInput");
        const statusFilter = document.getElementById("statusFilter");
        const rows = document.querySelectorAll("table tbody tr");

        function filterTable() {
            const keyword = searchInput.value.toLowerCase();
            const selectedStatus = statusFilter.value;

            rows.forEach(row => {
                const fullName = row.getAttribute("data-fullname");
                const status = row.getAttribute("data-status"); // "true" or "false"

                const matchName = fullName.includes(keyword);
                const matchStatus = !selectedStatus || status === selectedStatus;

                row.style.display = (matchName && matchStatus) ? "" : "none";
            });
        }

        searchInput.addEventListener("keyup", filterTable);
        statusFilter.addEventListener("change", filterTable);
    });
</script>
}
